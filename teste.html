<!DOCTYPE html>
<html>
<head>
  <title>Battery Status API Example</title>
  <script>
    window.onload = function () {
      function updateBatteryStatus(battery) {
        document.querySelector('#charging').textContent = battery.charging ? 'charging' : 'not charging';
        document.querySelector('#level').textContent = battery.level * 100 + "%";
        document.querySelector('#dischargingTime').textContent = battery.dischargingTime / 60 + " minutes";
		document.querySelector('#location').textContent = currentPosition();
		
		
	}
		function currentPosition(){
			if (!navigator.geolocation){
				alert("Geolocation is not supported by your browser");
			}
			else{
			  function success(position) {
				var latitude  = position.coords.latitude;
				var longitude = position.coords.longitude;
				if(navigator.onLine){
					document.querySelector('#location').textContent = "Latitude: " + latitude + "   Longitude: " + longitude;
					var msg = new SpeechSynthesisUtterance("Olá eu acabei de me acidentar no seguinte endereço: Latitude: " + latitude + "   Longitude: " + longitude);
					window.speechSynthesis.speak(msg);
				}
				else{
					document.querySelector('#location').textContent = "Latitude: " + latitude + "   Longitude: " + longitude;
				}
				
				}
				function error() {
					alert("Unable to retrieve your location");
				  };

				  //alert("Locating…");

				  navigator.geolocation.getCurrentPosition(success, error);
			}
			
		}

      navigator.getBattery().then(function(battery) {
        // Update the battery status initially when the promise resolves ...
        updateBatteryStatus(battery);

        // .. and for any subsequent updates.
        battery.onchargingchange = function () {
          updateBatteryStatus(battery);
        };

        battery.onlevelchange = function () {
          updateBatteryStatus(battery);
        };

        battery.ondischargingtimechange = function () {
          updateBatteryStatus(battery);
        };
      });
    };
  </script>
</head>
<body>
  <div id="charging">(charging state unknown)</div>
  <div id="level">(battery level unknown)</div>
  <div id="dischargingTime">(discharging time unknown)</div>
  <br><br>
  <div id="location">(location unknown)</div>
</body>
</html>